# سياسة الأمان

## نظرة عامة

تحدد هذه الوثيقة سياسات وإجراءات الأمان لمستودع الشهادة المتبادلة "الكانون أ" ضمن نظام GTFO_2.

## نطاقات الرمز المميز والتحكم في الوصول

### متطلبات رمز الوصول الشخصي لـ GitHub (PAT)

تتطلب سير العمل رمز وصول شخصي محدود النطاق مع الصلاحيات التالية:

**صلاحيات المستودع (لكل من canon-a و canon-b):**
- **المحتويات:** قراءة وكتابة
- **المشاكل:** قراءة وكتابة
- **طلبات السحب:** قراءة وكتابة
- **البيانات الوصفية:** قراءة
- **الإجراءات:** قراءة (إذا كانت إدارة سير العمل مطلوبة)

### تكوين القائمة المسموحة

يقيد سير عمل الشهادة التنفيذ على الجهات المخولة فقط:

```yaml
# المطالبون المخولون بالشهادة
allowlist:
  - "AshrafAlhajj"     # المهندس الرئيسي
  - "Raasid"           # مراقب/وكيل
```

## تدابير تقوية الأمان

### أمان سير العمل

1. **التحقق من المدخلات**
   - يتم التحقق من جميع مدخلات المستخدم قبل المعالجة
   - يجب أن تتطابق أسماء المستودعات مع الأنماط المتوقعة
   - أسماء الشاهدين مقيدة على الرفقاء المعروفين

2. **التحكم في التزامن**
   - تتضمن سير العمل مجموعات تزامن لمنع التنفيذ المتزامن
   - يتم تخفيف ظروف السباق من خلال القفل المناسب

3. **إدارة الأسرار**
   - يتم تخزين رموز PAT كأسرار مستودع
   - لا يتم تسجيل الأسرار أو كشفها في مخرجات سير العمل
   - نطاق الرمز المميز مقلل إلى الصلاحيات المطلوبة فقط

### أمان الشهادة

1. **التكامل التشفيري**
   - يتم تجميع جميع المطالبات باستخدام SHA-256
   - توفر SHA للالتزامات مراجع مقاومة للتلاعب
   - تستخدم الطوابع الزمنية تنسيق RFC3339 للاتساق

2. **التحقق من التوقيع**
   - تتطلب الشهادات ملفات بيانات JSON وملفات توقيع
   - تستخدم ملفات التوقيع اللاحقة `__sig.json` للتعريف الواضح
   - الإصدارات المستقبلية ستنفذ التوقيعات التشفيرية الحقيقية

3. **حماية الفرع**
   - تستخدم فروع الشهادة تسمية فريدة: `attest/by-${owner}/run-${id}`
   - تتضمن أسماء الفروع معرفات أحادية لمنع التعارض
   - جميع التغييرات تتطلب مراجعة طلب السحب

## الاستجابة للحوادث

### أنواع الحوادث الأمنية

1. **محاولات الشهادة غير المخولة**
   - مراقبة سجلات سير العمل للتحققات الفاشلة من القائمة المسموحة
   - مراجعة تعليقات المشاكل لطلبات الشهادة المشبوهة
   - تنبيه القيمين على المشروع فوراً

2. **تسريب الرمز المميز**
   - إلغاء PAT المسرب فوراً
   - توليد رمز جديد بنفس قيود النطاق
   - تحديث أسرار المستودع في جميع المستودعات المتأثرة
   - مراجعة تنفيذات سير العمل الأخيرة للنشاط غير المخول

## الامتثال والتدقيق

### مسار التدقيق

يحافظ النظام على مسارات تدقيق شاملة:
- يتم تسجيل جميع الشهادات بشكل دائم في تاريخ Git
- يتم تسجيل تنفيذات سير العمل في تاريخ الإجراءات
- يتم تتبع استخدام الرمز المميز من خلال سجلات تدقيق GitHub

### المراجعات المنتظمة

1. **المراجعات الأمنية الفصلية**
   - مراجعة صلاحيات الوصول والقوائم المسموحة
   - تدقيق نطاقات الرموز المميزة وأنماط الاستخدام
   - تحديث تكوينات الأمان حسب الحاجة

2. **التحقق من الشهادة**
   - التحقق من تكامل الشهادات المخزنة
   - التحقق من الإدخالات غير المتوقعة أو المشوهة
   - التحقق من اتساق ملف التوقيع

---

*إصدار سياسة الأمان: 1.0*  
*آخر تحديث: 2025-10-06*  
*المراجعة التالية: 2026-01-06*